"use strict";!function(a){function f(b){return a.extend({},e,b)}function g(a,b,c){var e={};e[d+"transform"]=c?"translate3d(0, "+b+"px, 0)":"translate3d("+b+"px, 0, 0)",a.css(e)}function i(b){a.extend(h,b)}function j(a){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||setTimeout)(a)}function k(a){return(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||clearTimeout)(a),null}function l(a){function p(){n._at=j(function(){m=+new Date-l,i=(h[n.cfg.animation]||h.linear)(m,b,f,e),g(d,i,o),m>=e?(k(n._at),g(d,c,o),a.cb&&a.cb.apply(n),n._isAni=!1,n.cfg.onChange&&n.cfg.onChange.apply(n)):p()})}var b=a.start||0,c=a.end||0,d=a.dom,e=a.time,f=c-b,i=b,l=+new Date,m=0,n=this,o=n.isVertical;n._at&&k(n._at),n._isAni=!0,p()}function m(){this._isAni&&(clearInterval(this._at),this._isAni=!1,N.apply(this))}function n(a,b,c){l.call(this,{dom:this.jBox,start:a,end:b,time:c||300,cb:N})}function o(a,b){var d=this;d.jPrev=a.on(c.click,function(){d.prev()}),d.jNext=b.on(c.click,function(){d.next()})}function p(){var b=0,d=this,f=(d.jItem,d.stepLength),g='<ol class="slider-steps">',h=d.cfg.indexFormat,i=null;for(d.cfg,b;f>b;b++)g+='<li class="step">'+(h?h.call(d,b):b)+"</li>";g+="</ol>",d.jWrap.append(g),i=d.cfg.indexBind?d.jWrap.find(".slider-steps").on(c.click,".step",function(){var c,b=a(this);b.hasClass("disable")||(c=i.find(".step").index(b),d.moveTo(c))}):d.jWrap.find(".slider-steps"),d.jSteps=i}function q(){var e,f,g,h,i,l,m,n,q,a='<div class="slider-wrapper"><div class="slider-content"></div></div>',b=this,c=b.cfg,d=null,j=1,k="h"===c.dir?!1:!0;b.isVertical=k,b.jWrap?(d=b.fragmentDom.clone(!0),b.jWrap.after(d),b.jWrap.remove(),delete b.jWrap,b.jBox=d):(d=b.jBox,b.fragmentDom=d.clone(!0)),d.wrap(a),b.jWrap=f=d.closest(".slider-wrapper"),b.jItem=e=d.children(),b.jContent=g=f.find(".slider-content"),c.ctrlBtn&&(f.append('<div class="slider-control"><span class="prev"><span class="prev-s"></span></span><span class="next"><span class="next-s"></span></span></div>'),o.call(b,f.find(".prev"),f.find(".next")),b.jCtrl=b.jWrap.find(".slider-control")),e.length>1?(h=e.width(),i=e.height(),c.unlimit&&(d.append(e.clone()),j=2,2===e.length&&(d.append(e.clone()),j=3),b.jItem=e=d.children()),n=e.length/j,k?(b.jItem.height(i),d.height(i*e.length),q=Math.ceil(i*e.length/j),g.width(d.width()).height(i),m=q-b.jWrap.height()+c.offset,b.current=c.index*i):(b.jItem.width(h),d.width(h*e.length),q=Math.ceil(h*e.length/j),g.height(d.height()),l=q-b.jWrap.width()+c.offset,b.current=c.index*h),b.wrapperSize=k?f.height():f.width(),b.itemSize=k?i:h,b.moveUnit=c.unit>0?b.itemSize*c.unit:b.wrapperSize,b.scope=k?m:l,b.stepLength=c.unit>0?Math.round(b.scope/b.moveUnit+1):Math.round(b.itemSize*n/b.wrapperSize),c.unlimit&&(b.stepLength+=Math.round((b.wrapperSize-b.itemSize)/b.moveUnit)),c.indexBtn&&p.apply(b),b.moveTo(c.index,!0)):(h=e.width(),i=e.height(),n=1,b.wrapperSize=k?f.height():f.width(),b.itemSize=k?i:h,b.moveUnit=0,b.scope=0,b.stepLength=1,k?(d.height(i),g.width(d.width()),m=0,f.addClass("slider-no-effect"),b.current=0,b.moveTo(0,!0)):(d.width(h),g.height(d.height()),l=0,f.addClass("slider-no-effect"),b.current=0,b.moveTo(0,!0)))}function C(a){m.apply(this),this.touched=!0,r=B(a),t=!1,u=!1,v=0,w=0,y.push(this),this.timer&&clearTimeout(this.timer)}function D(a){x=y[0],x&&x.cfg.drag&&!x.checkLock()?x.touched&&(s=B(a),G.call(x,x.isVertical?s.y-r.y:s.x-r.x),t&&a.preventDefault()):y.shift()}function E(){x&&(x.cfg.drag&&(r={},s={},t&&I.apply(x),x.touched=!1,t=!1),M.apply(x),x.moveDist=0,x=null,y=[])}function F(a,b){if(this.isVertical&&Math.abs(a)>Math.abs(b)||!this.isVertical&&Math.abs(b)>Math.abs(a)){if(y.shift(),y.length)return x=y[0],F.call(x,a,b),void 0;t=!1,this.touched=!1}else t=!0;u=!0}function G(a){return u?(v=a>0,v&&this.checkLockPrev()&&(a=0),!v&&this.checkLockNext()&&(a=0),w=a,H.call(this,a),void 0):(F.call(this,s.x-r.x,s.y-r.y),void 0)}function H(a){var b=this.isVertical,c=this.current,d=this.scope;a=c+a,this.cfg.bounce||this.cfg.unlimit||(a=Math.min(0,Math.max(a,-1*d))),g(this.jBox,a,b),this.moveDist=a}function I(){var b=(this.isVertical,this.currentIndex),c=this.moveUnit,f=(this.jItem.length,this.stepLength,Math.abs(w)),g=0;0!==v&&(this.cfg.unlimit?v?this.prev():this.next():(f>c/4&&(g=(v?-1:1)*Math.ceil(f/c)),b+=g,b=Math.max(0,Math.min(b,this.stepLength-1)),this.moveTo(b)))}function J(){var a=this.currentIndex,b=this.cfg,c=this.stepLength,d=this.jPrev,e=this.jNext;b.unlimit?1===c&&(d.addClass("disable"),e.addClass("disable")):(0===a?d.addClass("disable"):d.removeClass("disable"),a===c-1?e.addClass("disable"):e.removeClass("disable"))}function K(){var a=this.currentIndex,c=(this.cfg,this.stepLength);this.jPrev,this.jNext,this.jSteps.find(".step").removeClass("current").eq(a%c).addClass("current")}function L(){return this.currentIndex%this.stepLength}function M(){var a=this,b=a.cfg;b.autoPlay&&(a.timer&&clearTimeout(a.timer),a.timer=setTimeout(function(){var b=a.currentIndex+1;a.cfg.unlimit?a.moveTo(b):(b%=a.stepLength,a.moveTo(b)),M.apply(a)},a.cfg.duration))}function N(){var a,b,c;this.cfg.unlimit&&!this.touched&&(a=this.currentIndex,b=this.stepLength,c=Math.ceil(this.jItem.length*this.itemSize/this.moveUnit),b>1&&(1>=a?(a=b+1,this.setIndexTo(a)):a>=c-2&&(a=c-2-b,this.setIndexTo(a))))}function O(a,b){var c=this,e=(c.isVertical,c.jItem.length),f=c.moveUnit,g=c.scope,h=c.cfg.offset,i=c.stepLength,j=0;return c.cfg.unlimit?i>1?(0>=a?(a=i,c.setIndexTo(a+1)):a>=e-1&&(a=e-1-i,c.setIndexTo(a-1)),j=-1*a*f+h):(a=0,j=h):(a%=e,j=Math.max(-1*a*f+h,-1*g)),b||c.cfg.noAnimate?n.call(c,j,j,0):n.call(c,c.touched?c.moveDist:c.current,j),c.currentIndex=a,c.current=j,c.jSteps&&K.apply(c),c.cfg.ctrlBtn&&J.apply(c),M.apply(c),c}function P(a){var h,b=this.isVertical,e=(this.jWrap,this.stepLength,this.moveUnit),f=this.cfg.offset;if("NaN"!==a.toString())return h=-1*a*e+f,g(this.jBox,h,b),this.currentIndex=a,this.current=h,this}function Q(){var a=this.currentIndex-1,b=this.checkLock()||this.checkLockPrev();if(!b){if(this.cfg.unlimit)this.moveTo(a);else{if(0>a)return;this.moveTo(a)}return this}}function R(){var a=this.currentIndex+1,b=this.checkLock()||this.checkLockNext();if(!b){if(this.cfg.unlimit)this.moveTo(a);else{if(a>=this.stepLength)return;this.moveTo(a)}return this}}function S(b){return this.cfg=f(a.extend(this.cfg,{index:this.currentIndex},b)),this.timer&&clearTimeout(this.timer),A--,W.apply(this),this}function T(){var a="";this.jWrap.remove();for(a in this)delete this[a];this.__proto__=null,A--,0===A&&V()}function U(){var b=this;this.jContent.on(c.start,function(a){C.call(b,a)}),z||(a(document).on(c.move,D).on(c.end,E),z=!0)}function V(){a(document).off(c.move,D).off(c.end,E),z=!1}function W(){this.currentIndex=this.cfg.index,this.cfg.extendAnimate&&i(this.cfg.extendAnimate),q.apply(this),U.apply(this),M.apply(this),A++}function X(b,c){function e(){return d}function g(){return d=!0,this}function h(){return d=!1,this}function k(){return i}function l(){return j}function m(){return i=!0,this}function n(){return i=!1,this}function o(){return j=!0,this}function p(){return j=!1,this}var d,i,j;return this.jBox=a(b),this.cfg=f(c||{}),d=!1,this.checkLock=e,this.lock=g,this.unlock=h,i=!1,j=!1,this.checkLockPrev=k,this.lockPrev=m,this.unlockPrev=n,this.checkLockNext=l,this.lockNext=o,this.unlockNext=p,W.apply(this),this}var b="ontouchend"in document,c={click:"click",start:b?"touchstart":"mousedown",move:b?"touchmove":"mousemove",end:b?"touchend":"mouseup"},d=function(){var d,g,a=document.createElement("div"),b=a.style,c=["WebkitT","MozT","MsT"],e=0,f=3;for(e;f>e;e++)if(d=c[e],""===b[d+"ransform"]){g="-"+d.replace("T","").toLowerCase()+"-";break}return g}(),e={unlimit:!0,ctrlBtn:!0,indexBtn:!0,unit:1,offset:0,index:0,dir:"h",autoPlay:!1,duration:5e3,bounce:!0,drag:!0,indexBind:!0,noAnimate:!1,animation:"ease-out-back"},h={"ease-out-back":function(a,b,c,d){var e=1.70158;return c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},linear:function(a,b,c,d){return a/d*c+b}},r={},s={},t=!1,u=!1,v=!0,w=0,x=null,y=[],z=!1,A=0,B=function(a){var c,d,a=a.originalEvent?a.originalEvent:a,b=a.touches;return b?(c=b[0].pageX,d=b[0].pageY):(c=a.clientX,d=a.clientY),{x:c,y:d}};X.prototype={prev:Q,next:R,setIndexTo:P,moveTo:O,getIndex:L,refresh:S,destroy:T},"function"==typeof define&&define.amd?define([],function(){return X}):"undefined"!=typeof module&&module.exports?module.exports=X:window.NiceSlider=X}(window.jQuery||window.Zepto);