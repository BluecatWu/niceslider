(function(f){function E(a){return f.extend({},L,a)}function M(a){return(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||setTimeout)(a)}function z(a){(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||clearTimeout)(a);return null}function N(a){function b(){l._at=M(function(){f=+new Date-g;e=(A[l.cfg.animation]||A.linear)(f,c,O,k);n(m,e,h);f>=k?(z(l._at),n(m,d,h),a.cb&&a.cb.apply(l),l._isAni=!1,l.cfg.onChange&&
l.cfg.onChange.apply(l)):b()})}var c=a.start||0,d=a.end||0,m=a.dom,k=a.time,O=d-c,e=c,g=+new Date,f=0,h=this.isVertical,l=this;this._at&&z(this._at);this._isAni=!0;b()}function P(){this._isAni&&(z(this._at),this._isAni=!1,F.apply(this))}function Q(a,b){var c=this;this.jPrev=a.on(g.click,function(){c.prev()});this.jNext=b.on(g.click,function(){c.next()})}function R(){var a=0,b=this.stepLength,c='<ol class="slider-steps">',d=this.cfg.indexFormat,m=this,k=null;for(a;a<b;a++)c+='<li class="step">'+(d?
d.call(m,a):a)+"</li>";this.jWrap.append(c+"</ol>");this.jSteps=k=this.cfg.indexBind?this.jWrap.find(".slider-steps").on(g.click,".step",function(){var a=f(this);a.hasClass("disable")||(a=k.find(".step").index(a),m.moveTo(a))}):this.jWrap.find(".slider-steps")}function S(){var a=this.cfg,b=null,c,d,m,k,e,g=1,f="h"===a.dir?!1:!0,h,n,l;this.isVertical=f;this.jWrap?(b=this.fragmentDom.clone(!0),this.jWrap.after(b),this.jWrap.remove(),delete this.jWrap,this.jBox=b):(b=this.jBox,this.fragmentDom=b.clone(!0));
b.wrap('<div class="slider-wrapper"><div class="slider-content"></div></div>');this.jWrap=d=b.closest(".slider-wrapper");this.jItem=c=b.children();this.jContent=m=d.find(".slider-content");a.ctrlBtn&&(d.append('<div class="slider-control"><span class="prev"><span class="prev-s"></span></span><span class="next"><span class="next-s"></span></span></div>'),Q.call(this,d.find(".prev"),d.find(".next")),this.jCtrl=this.jWrap.find(".slider-control"));1<c.length?(k=c.width(),e=c.height(),a.unlimit&&(b.append(c.clone()),
g=2,2===c.length&&(b.append(c.clone()),g=3),this.jItem=c=b.children()),l=c.length/g,f?(this.jItem.height(e),b.height(e*c.length),c=Math.ceil(e*c.length/g),m.width(b.width()).height(e),n=c-this.jWrap.height()+a.offset,this.current=a.index*e):(this.jItem.width(k),b.width(k*c.length),c=Math.ceil(k*c.length/g),m.height(b.height()),h=c-this.jWrap.width()+a.offset,this.current=a.index*k),this.wrapperSize=f?d.height():d.width(),this.itemSize=f?e:k,this.moveUnit=0<a.unit?this.itemSize*a.unit:this.wrapperSize,
this.scope=f?n:h,this.stepLength=0<a.unit?Math.round(this.scope/this.moveUnit+1):Math.round(this.itemSize*l/this.wrapperSize),a.unlimit&&a.unit&&(this.stepLength+=Math.round((this.wrapperSize-a.offset-this.itemSize)/this.moveUnit)),a.indexBtn&&R.apply(this),this.moveTo(a.index,0)):(k=c.width(),e=c.height(),this.wrapperSize=f?d.height():d.width(),this.itemSize=f?e:k,this.scope=this.moveUnit=0,this.stepLength=1,f?(b.height(e),m.width(b.width())):(b.width(k),m.height(b.height())),d.addClass("slider-no-effect"),
this.current=0,this.moveTo(0,0))}function T(a){P.apply(this);this.touched=!0;p=G(a);B=q=!1;C=r=0;h.push(this)}function H(a){(e=h[0])&&e.cfg.drag&&!e.checkLock()?e.touched&&(e.timer&&clearTimeout(e.timer),t=G(a),U.call(e,e.isVertical?t.y-p.y:t.x-p.x),q&&a.preventDefault()):h.shift()}function v(a){e&&(e.cfg.drag&&(p={},t={},q&&V.apply(e),q=e.touched=!1),w.apply(e),e.moveDist=0);e=null;h=[]}function I(a,b){if(this.isVertical&&Math.abs(a)>Math.abs(b)||!this.isVertical&&Math.abs(b)>Math.abs(a)){h.shift();
if(h.length){e=h[0];I.call(e,a,b);return}this.touched=q=!1}else q=!0;B=!0}function U(a){if(B){(r=0<a)&&this.checkLockPrev()&&(a=0);!r&&this.checkLockNext()&&(a=0);C=a;var b=this.isVertical,c=this.scope;a=this.current+a;this.cfg.bounce||this.cfg.unlimit||(a=Math.min(0,Math.max(a,-1*c)));n(this.jBox,a,b);this.moveDist=a}else I.call(this,t.x-p.x,t.y-p.y)}function V(){var a=this.currentIndex,b=this.moveUnit,c=Math.abs(C),d=0;0!==r&&(this.cfg.unlimit?r?this.prev():this.next():(c>b/4&&(d=(r?-1:1)*Math.ceil(c/
b)),a=Math.max(0,Math.min(a+d,this.stepLength-1)),this.moveTo(a)))}function W(){var a=this.currentIndex,b=this.stepLength,c=this.jPrev,d=this.jNext;this.cfg.unlimit?1===b&&(c.addClass("disable"),d.addClass("disable")):(0===a?c.addClass("disable"):c.removeClass("disable"),a===b-1?d.addClass("disable"):d.removeClass("disable"))}function X(){var a=this.currentIndex,b=this.stepLength;this.jSteps.find(".step").removeClass("current").eq(a%b).addClass("current")}function w(){var a=this;this.cfg.autoPlay&&
(this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){var b=a.currentIndex+1;a.cfg.unlimit||(b%=a.stepLength);a.moveTo(b);w.apply(a)},this.cfg.duration))}function F(){var a,b,c;this.cfg.unlimit&&!this.touched&&(a=this.currentIndex,b=this.stepLength,c=Math.ceil(this.jItem.length*this.itemSize/this.moveUnit),1<b&&(1>=a?this.setIndexTo(b+1):a>=c-2&&this.setIndexTo(c-2-b)))}function Y(){var a=this;this.jContent.on(g.start,function(b){T.call(a,b)});D||(f(document).on(g.move,H).on(g.end,
v).on(g.cancel,v),D=!0)}function J(){this.currentIndex=this.cfg.index;this.cfg.extendAnimate&&f.extend(A,this.cfg.extendAnimate);S.apply(this);Y.apply(this);w.apply(this);x++}function y(a,b){this.jBox=f(a);this.cfg=E(b||{});var c=!1;this.checkLock=function(){return c};this.lock=function(){c=!0;return this};this.unlock=function(){c=!1;return this};var d=!1,e=!1;this.checkLockPrev=function(){return d};this.lockPrev=function(){d=!0;return this};this.unlockPrev=function(){d=!1;return this};this.checkLockNext=
function(){return e};this.lockNext=function(){e=!0;return this};this.unlockNext=function(){e=!1;return this};J.apply(this);return this}var u="ontouchend"in document,g={click:"click",start:u?"touchstart":"mousedown",move:u?"touchmove":"mousemove",end:u?"touchend":"mouseup",cancel:u?"touchcancel":"mousecancel"},K=function(){var a=document.createElement("div").style,b="";""===a.WebkitTransform?b="-webkit-":""===a.MozTransform?b="-moz-":""===a.MsTransform&&(b="-ms-");return b}(),L={unlimit:!0,ctrlBtn:!0,
indexBtn:!0,unit:1,offset:0,index:0,dir:"h",autoPlay:!1,duration:5E3,bounce:!0,drag:!0,indexBind:!0,noAnimate:!1,animation:"ease-out-back"},n=function(a,b,c){var d={};u?(d[K+"transform"]=c?"translate3d(0, "+b+"px, 0)":"translate3d("+b+"px, 0, 0)",a.css(d),n=function(a,b,c){d[K+"transform"]=c?"translate3d(0, "+b+"px, 0)":"translate3d("+b+"px, 0, 0)";a.css(d)}):(c?d.top=b+"px":d.left=b+"px",a.css(d),n=function(a,b,c){c?d.top=b+"px":d.left=b+"px";a.css(d)})},A={"ease-out-back":function(a,b,c,d){return c*
((a=a/d-1)*a*(2.70158*a+1.70158)+1)+b},linear:function(a,b,c,d){return a/d*c+b}},p={},t={},q=!1,B=!1,r=!0,C=0,e=null,h=[],D=!1,x=0,G=function(a){a=a.originalEvent?a.originalEvent:a;var b=a.touches,c;b?(c=b[0].pageX,a=b[0].pageY):(c=a.clientX,a=a.clientY);return{x:c,y:a}};y.prototype={prev:function(){var a=this.currentIndex-1;if(!(this.checkLock()||this.checkLockPrev()||!this.cfg.unlimit&&0>a))return this.moveTo(a),this},next:function(){var a=this.currentIndex+1;if(!(this.checkLock()||this.checkLockNext()||
!this.cfg.unlimit&&a>=this.stepLength))return this.moveTo(a),this},setIndexTo:function(a){var b=this.isVertical,c=this.moveUnit,d=this.cfg.offset;if("NaN"!==a.toString())return c=-1*a*c+d,n(this.jBox,c,b),this.currentIndex=a,this.current=c,this},moveTo:function(a,b){var c=this.jItem.length,d=this.moveUnit,e=this.scope,f=this.cfg.offset,g=this.stepLength,h=0;this.cfg.unlimit?1<g?(0>=a?(a=g,this.setIndexTo(a+1)):a>=c-1&&(a=c-1-g,this.setIndexTo(a-1)),h=-1*a*d+f):(a=0,h=f):(a%=c,h=Math.max(-1*a*d+f,
-1*e));c=this.cfg.noAnimate?0:b;N.call(this,{dom:this.jBox,start:this.touched?this.moveDist:this.current,end:h,time:"number"===typeof c?c:300,cb:F});this.currentIndex=a;this.current=h;this.jSteps&&X.apply(this);this.cfg.ctrlBtn&&W.apply(this);w.apply(this);return this},getIndex:function(){return this.currentIndex%this.stepLength},refresh:function(a){this.cfg=E(f.extend(this.cfg,{index:this.currentIndex},a));this.timer&&clearTimeout(this.timer);x--;J.apply(this);return this},destroy:function(){var a=
"";this.jWrap.remove();for(a in this)delete this[a];this.__proto__=null;x--;0===x&&(f(document).off(g.move,H).off(g.end,v).off(g.cancel,v),D=!1)}};"function"===typeof define&&define.amd?define([],function(){return y}):"undefined"!==typeof module&&module.exports?module.exports=y:window.NiceSlider=y})(window.jQuery||window.Zepto);